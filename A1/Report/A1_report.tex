\documentclass[a4 paper]{article}
% Set target color model to RGB
\usepackage[inner=2.0cm,outer=2.0cm,top=2.5cm,bottom=2.5cm]{geometry}
\usepackage{setspace}
\usepackage[rgb]{xcolor}
\usepackage{verbatim}
\usepackage{subcaption}
\usepackage{amsgen,amsmath,amstext,amsbsy,amsopn,tikz,amssymb,tkz-linknodes}
\usepackage{fancyhdr}
\usepackage[colorlinks=true, urlcolor=blue,  linkcolor=blue, citecolor=blue]{hyperref}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{rotating}
\usepackage{floatrow}
\usepackage{subfig}
\usepackage{enumitem}
% for placing picture here
% \usepackage[section]{placeins}

\usepackage{booktabs}
\input{macros.tex}

\begin{document}
\homework{Assignment 1 Report}{Date: February 12, 2019}{}{\bf 2016CS10363}{\bf Manish Tanwar}{NetId(s)}

\section{A}

% *********** 2 ***************
\section{Locally Weighted Linear Regression:}

\subsection*{(a) Linear Regression (unweighted):}

$$ \hspace*{-0.75cm} \theta = 
\begin{bmatrix}
	\theta_0 \\  \theta_1 \\
\end{bmatrix}
= 
\begin{bmatrix}
	0.327680 \\
	0.175316
\end{bmatrix} $$

\vspace*{-0.5cm}
\begin{figure}[!htb]
	\centering
	% \hspace*{-0.9in} % width=100mm
	\includegraphics[width = 90mm]{./Plots/2a.png}
	\caption{Linear Regressin Plot (Underfitting)}
  	\label{fig:boat1}
	}
\end{figure}

Linear Regression(unweighted) is not a good fit for the data as shown in the Figure 1(underfitting).

\subsection*{(b) Locally Weighted Linear Regression:}
\vspace*{0.3cm}
$$ \hspace*{-2.5cm}\text{Weights}: \hspace*{1.9cm} w^{(i)} = \exp\left(-\frac{(x-x^{(i)})^2}{2\tau^2}\right) \qaud \quad \quad (\text{where } \tau = \text{Bandwidth Parameter}) $$

$$ \hspace*{-2.7cm} \text{Error Function: } \hspace*{0.9cm} J(\theta) = \frac{1}{2m} (X\theta - Y)^TW(X\theta - Y) \hspace*{1cm} (\text{where } W = diag(w^{(i)}) \hspace*{0.5mm}) $$


$$ \hspace*{-5.8cm} \text{Minima:} \hspace*{2.3cm} \nabla_{\theta}J(\theta) = 0 \quad \Rightarrow \quad \theta = (X^TWX)^{-1}X^TWY $$

\newpage
\hspace*{-0.2cm}
\textbf{Plots:}
\begin{figure}[!htb]
	\centering
	% \hspace*{-0.9in} % width=100mm
	\includegraphics[width = 90mm]{./Plots/2b(08).png}
	\caption{Locally Weighted Linear Regressin Plot ($\tau = 0.8$)}
  	\label{fig:boat1}
	}
\end{figure}
\vspace*{-0.5cm}
\subsection*{(c) Plots on Varying Bandwidth Parameter($\tau$)}

\vspace*{-0.7cm}
\begin{figure}[H]
	\centering
    \begin{floatrow}
	\hspace*{-0.4in}
      \ffigbox[\FBwidth]{\caption{$\tau = 0.1$}\label{fig7}}{%
      \includegraphics[width=90mm]{./Plots/2b(01).png}
      }
      \ffigbox[\FBwidth]{\caption{$\tau = 0.3$}\label{fig8}}{%
		\includegraphics[width=90mm]{./Plots/2b(03).png}
      }
    \end{floatrow}
\end{figure}

\vspace*{-0.82cm}
\begin{figure}[H]
	\centering
    \begin{floatrow}
	\hspace*{-0.4in}
      \ffigbox[\FBwidth]{\caption{$\tau = 2$}\label{fig7}}{%
      \includegraphics[width=90mm]{./Plots/2b(2).png}
      }
      \ffigbox[\FBwidth]{\caption{$\tau = 10$}\label{fig8}}{%
		\includegraphics[width=90mm]{./Plots/2b(10).png}
      }
    \end{floatrow}
\end{figure}

\subsection*{Analysis:}
	
\begin{itemize}
	\item When Bandwidth Parameter($\tau$) is:
	\begin{itemize}
	\item \textbf{Too Small:} the model \textbf{overfits} the training data.
	\item \textbf{Too Large:} The model tries to \textbf{underfits} the training data.
	\end{itemize}
	\item $\tau = 0.8$ works the best.
\end{itemize}

% *********** 3 ***************
\section{Logistic Regression:}
\vspace*{0.3cm}

$$ \hspace*{-4.3cm} \text{Log Likelihood:} \hspace*{0.8cm} LL(\theta) = \sum_{i=1}^{m} y^{(i)} log(h_{\theta}(x^{(i)})) + (1 - y^{(i)}) log(1-h_{\theta}(x^{(i)}))  $$

$$ \hspace*{0.7cm} \nabla_{\theta}LL(\theta) = X^T(Y - g(X\theta)) \hspace{2cm} (\text{where } g(x) = \frac{1}{1 + \exp(-x)}) $$

$$ \hspace*{-6.6cm} \text{Hessian Matrix: } \hspace*{0.9cm} H = \nabla_{\theta}^2LL(\theta) = -X^T D X \hspace*{2cm} $$
$$ \hspace*{4.6cm} (\text{where } D = diag( \hspace*{0.5mm} g(x^{(i)}^T\theta) (1 - g(x^{(i)}^T\theta)) \hspace*{0.5mm}) $$

\vspace*{0.2cm}
\hspace*{-0.2cm} 
\textbf{Newton's Method:}
$$\hspace*{-2.65cm} \theta^{(t+1)} = \theta^{(t)} - H^{-1}\nabla_{\theta}LL(\theta)\big|_{\theta_{t}}$$

\vspace*{0.2cm}
\hspace*{-0.2cm} 
\textbf{Convergence Condition:}
$$ \hspace*{1.75cm} \big| \theta_j^{(t+1)} - \theta_j^{(t)} \big| < \epsilon \hspace*{2.65cm} (\text{for a sufficiently small } \epsilon)$$

\hspace*{-0.2cm} 
\textbf{Resulting Parameters:}
$$ \hspace*{-3.75cm} \theta = 
\begin{bmatrix}
	\theta_0 \\  \theta_1 \\ \theta_2 \\
\end{bmatrix}
= 
\begin{bmatrix}
	0.223295 \\  1.962616 \\ -1.964861\\
\end{bmatrix} $$

\hspace*{-0.2cm} 
Decision Boundary is the straight line boundary separating the region where $h_\theta(x) \geq 0.5 \hspace*{0.5mm} (\text{class } y=1)$ from
where $h_\theta(x) \leq 0.5 \hspace*{0.5mm} (\text{class } y=0)$.

\vspace*{0.5cm}
\hspace*{-0.2cm} 
\textbf{Plot:}
\begin{figure}[!htb]
	\centering
	\hspace*{-0.9in} % width=100mm
	  \includegraphics[width = 90mm]{./Plots/3.png}
	}
\end{figure}

\section{Gaussian Discrmimant Analysis:}

\newpage 
a
\end{document}